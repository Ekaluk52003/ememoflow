{% extends "_base.html" %}

{% block title %}All Documents{% endblock %}

{% block content %}

<!-- Hero Section -->
<div class="relative z-10 mb-10">
    <h1 class="relative mb-3 text-4xl font-bold tracking-tight text-gray-900 md:text-5xl dark:text-white">
        Manage your <br>
        <span class="text-transparent bg-clip-text bg-gradient-to-r to-fuchsia-500 from-neon-violet text-glow">Mission Critical Docs</span>
    </h1>
    <p class="max-w-2xl text-lg text-gray-600 dark:text-gray-400">
        Review, approve, and track document workflows with real-time updates.
    </p>
    <!-- Background Glow -->
    <div class="absolute -top-20 -left-20 w-96 h-96 bg-neon-violet/20 blur-[100px] rounded-full -z-10 pointer-events-none"></div>
</div>

<!-- Search and Filter Form -->
<form id="search-form" class="relative z-10 mb-8" hx-get="{% url 'document_approval:document_list' %}" hx-trigger="submit, change from:#workflow-filter, change from:#status-filter, change from:#mine-filter, change from:#start-date, change from:#end-date" hx-target="#document-list" hx-swap="innerHTML">
    
    <!-- Main Search Bar -->
    <div class="bg-white dark:bg-[#0a0a0a] backdrop-blur-md rounded-2xl p-2 shadow-lg border border-gray-200 dark:border-white/10 flex flex-col md:flex-row md:items-center gap-2">
        
        <!-- Search Input -->
        <div class="flex relative flex-1 items-center px-3">
            <i data-lucide="search" class="absolute left-3 w-5 h-5 text-gray-400"></i>
            <input type="text" name="search" class="py-2 pl-10 w-full text-sm placeholder-gray-500 text-gray-900 bg-transparent border-none focus:ring-0 dark:text-white md:text-base" placeholder="Search references..." value="{{ search_query }}">
        </div>

        <div class="hidden md:block w-[1px] h-8 bg-gray-200 dark:bg-white/10"></div>

        <!-- Workflow Filter -->
        <div class="relative md:w-48">
             <select id="workflow-filter" name="workflow" class="py-2 pr-8 pl-3 w-full text-sm font-medium text-gray-700 bg-transparent border-none appearance-none cursor-pointer focus:ring-0 dark:text-gray-300">
                <option value="" class="bg-white dark:bg-[#1e1e1e] text-gray-900 dark:text-white">All Workflows</option>
                {% for workflow in workflows %}
                    <option value="{{ workflow.id }}" {% if selected_workflow == workflow.id %}selected{% endif %} class="bg-white dark:bg-[#1e1e1e] text-gray-900 dark:text-white">{{ workflow.name }}</option>
                {% endfor %}
             </select>
             <i data-lucide="chevron-down" class="absolute right-3 top-1/2 w-4 h-4 text-gray-400 -translate-y-1/2 pointer-events-none"></i>
        </div>
        
        <div class="hidden md:block w-[1px] h-8 bg-gray-200 dark:bg-white/10"></div>

        <!-- Status Filter -->
        <div class="relative md:w-40">
             <select id="status-filter" name="status" class="py-2 pr-8 pl-3 w-full text-sm font-medium text-gray-700 bg-transparent border-none appearance-none cursor-pointer focus:ring-0 dark:text-gray-300">
                <option value="" class="bg-white dark:bg-[#1e1e1e] text-gray-900 dark:text-white">All Statuses</option>
                {% for status, display in status_choices %}
                    <option value="{{ status }}" {% if selected_status == status %}selected{% endif %} class="bg-white dark:bg-[#1e1e1e] text-gray-900 dark:text-white">{{ display }}</option>
                {% endfor %}
             </select>
             <i data-lucide="chevron-down" class="absolute right-3 top-1/2 w-4 h-4 text-gray-400 -translate-y-1/2 pointer-events-none"></i>
        </div>

        <!-- Filter Button -->
        <button type="submit" class="px-6 py-2.5 text-sm font-semibold text-gray-900 bg-gray-100 rounded-xl transition-colors dark:bg-white/10 hover:bg-gray-200 dark:hover:bg-white/20 dark:text-white">
            Filter
        </button>
    </div>
    
    <!-- Secondary Filters (Date & My Submissions) -->
    <div x-data="{ showFilters: false }">
        <div class="flex justify-end mt-2">
            <button type="button" @click="showFilters = !showFilters" class="flex gap-1 items-center text-xs font-medium text-gray-500 dark:text-gray-400 hover:text-neon-violet">
                <span x-text="showFilters ? 'Hide Advanced Filters' : 'Show Advanced Filters'"></span>
                <i data-lucide="sliders-horizontal" class="w-3 h-3"></i>
            </button>
        </div>

        <div x-show="showFilters" x-collapse class="mt-2 grid grid-cols-1 sm:grid-cols-3 gap-4 p-4 bg-gray-50 dark:bg-[#0a0a0a] rounded-xl border border-gray-200 dark:border-white/10">
            <div>
                <label for="start-date" class="block mb-1 text-xs font-medium text-gray-500 dark:text-gray-400">Date From</label>
                <input id="start-date" name="start_date" type="date" value="{{ selected_start_date }}" class="block w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-[#050505] rounded-lg border border-gray-200 dark:border-white/10 focus:ring-1 focus:ring-neon-violet focus:border-neon-violet dark:[color-scheme:dark]">
            </div>
            <div>
                <label for="end-date" class="block mb-1 text-xs font-medium text-gray-500 dark:text-gray-400">Date To</label>
                <input id="end-date" name="end_date" type="date" value="{{ selected_end_date }}" class="block w-full px-3 py-2 text-sm text-gray-900 dark:text-white bg-white dark:bg-[#050505] rounded-lg border border-gray-200 dark:border-white/10 focus:ring-1 focus:ring-neon-violet focus:border-neon-violet dark:[color-scheme:dark]">
            </div>
            <div class="flex items-end">
                <label class="flex items-center gap-2 p-2.5 w-full text-sm text-gray-900 dark:text-white bg-white dark:bg-[#050505] rounded-lg border border-gray-200 dark:border-white/10 cursor-pointer hover:border-neon-violet/50 transition-colors">
                    <input id="mine-filter" type="checkbox" name="mine" value="1" class="w-4 h-4 bg-gray-100 rounded border-gray-300 text-neon-violet focus:ring-neon-violet dark:bg-gray-700 dark:border-gray-600" {% if selected_mine %}checked{% endif %}>
                    <span class="text-sm font-medium">My Submissions Only</span>
                </label>
            </div>
        </div>
    </div>
</form>

<!-- Document List -->
<div id="document-list" class="relative z-0">
    {% include "partials/document_list_partial.html" %}
</div>

{% endblock %}
